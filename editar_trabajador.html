<!DOCTYPE html>
<html>
<head>
    <title>Editar Datos del Trabajador</title>
    <style>
        body { font-family: sans-serif; }
        .form-group { margin-bottom: 10px; }
        .form-group label { display: inline-block; width: 150px; text-align: right; margin-right: 10px; }
        .form-group input[type="text"] { width: 200px; padding: 5px; border: 1px solid #ddd; }
        .mensaje-error { color: red; margin-top: 10px; }
        .mensaje-exito { color: green; margin-top: 10px; }
    </style>
</head>
<body>
    <h1>Editar Datos del Trabajador</h1>

    <form method="POST" action="/editar_trabajador">
        <div class="form-group">
            <label for="cedula_buscar">Introduce Número de Cédula:</label>
            <input type="text" id="cedula_buscar" name="cedula_buscar" required>
            <button type="submit">Cargar</button>
        </div>
    </form>

    {% if mensaje_error %}
        <p class="mensaje-error">{{ mensaje_error }}</p>
    {% endif %}

    {% if mensaje_exito %}
        <p class="mensaje-exito">{{ mensaje_exito }}</p>
    {% endif %}

</body>
</html><!DOCTYPE html>
<html>
<head>
    <title>Editar Datos del Trabajador</title>
    <style>
        body { font-family: sans-serif; }
        .form-section { margin-bottom: 20px; border: 1px solid #ccc; padding: 15px; }
        .form-section h3, .form-section h4 { margin-top: 0; }
        .form-group { margin-bottom: 10px; }
        .form-group label { display: inline-block; width: 200px; text-align: right; margin-right: 10px; }
        .form-group input[type="text"],
        .form-group input[type="date"],
        .form-group input[type="email"],
        .form-group select { width: 250px; padding: 5px; border: 1px solid #ddd; }
        .form-group input[type="checkbox"] { margin-left: 200px; }
        .hidden { display: none; }
        #datos-conyuge, #datos-familiares, #datos-hijos-container, #cantidad-hijos-container, #tratamiento-container, #tipo-discapacidad-container { border: 1px dashed #aaa; padding: 10px; margin-top: 10px; }
        .hijo-form { border: 1px solid #eee; padding: 10px; margin-bottom: 10px; }
        .mensaje-exito { color: green; margin-top: 10px; }
        .mensaje-confirmacion {
            border: 1px solid #ccc;
            padding: 10px;
            margin-top: 20px;
            background-color: #f9f9f9;
        }
        .mensaje-confirmacion button {
            margin-right: 10px;
            padding: 8px 15px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <h1>Editar Datos del Trabajador</h1>

    {% if mensaje_exito %}
        <p class="mensaje-exito">{{ mensaje_exito }}</p>
    {% endif %}

    <form method="POST" action="/actualizar_trabajador" onsubmit="return confirmarGuardado()">
        <input type="hidden" name="cedula_original" value="{{ cedula_buscar }}">

        <div class="form-section">
            <h3>Datos del Trabajador</h3>
            <div class="form-group">
                <label for="tipo_trabajador">Tipo de trabajador:</label>
                <select id="tipo_trabajador" name="tipo_trabajador">
                    <option value="Empleado" {% if trabajador and trabajador.tipo_trabajador == 'Empleado' %}selected{% endif %}>Empleado</option>
                    <option value="Obrero" {% if trabajador and trabajador.tipo_trabajador == 'Obrero' %}selected{% endif %}>Obrero</option>
                </select>
            </div>
        </div>

        <div class="form-section">
            <h3>Datos Personales</h3>
            <div class="form-group">
                <label for="nombres">Nombres:</label>
                <input type="text" id="nombres" name="nombres" value="{% if trabajador %}{{ trabajador.nombres }}{% endif %}" required>
            </div>
            <div class="form-group">
                <label for="apellidos">Apellidos:</label>
                <input type="text" id="apellidos" name="apellidos" value="{% if trabajador %}{{ trabajador.apellidos }}{% endif %}" required>
            </div>
            <div class="form-group">
                <label for="cedula">Cédula:</label>
                <input type="text" id="cedula" name="cedula" value="{% if trabajador %}{{ trabajador.cedula }}{% endif %}" required readonly>
            </div>
            <div class="form-group">
                <label for="rif">RIF:</label>
                <input type="text" id="rif" name="rif" value="{% if trabajador %}{{ trabajador.rif }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="genero">Género:</label>
                <select id="genero" name="genero">
                    <option value="Masculino" {% if trabajador and trabajador.genero == 'Masculino' %}selected{% endif %}>Masculino</option>
                    <option value="Femenino" {% if trabajador and trabajador.genero == 'Femenino' %}selected{% endif %}>Femenino</option>
                </select>
            </div>
            <div class="form-group">
                <label for="fecha_nacimiento">Fecha de nacimiento:</label>
                <input type="date" id="fecha_nacimiento" name="fecha_nacimiento" value="{% if trabajador %}{{ trabajador.fecha_nacimiento }}{% endif %}" onchange="calcularEdad()">
            </div>
            <div class="form-group">
                <label for="lugar_nacimiento">Lugar de nacimiento:</label>
                <input type="text" id="lugar_nacimiento" name="lugar_nacimiento" value="{% if trabajador %}{{ trabajador.lugar_nacimiento }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="edad">Edad:</label>
                <input type="text" id="edad" name="edad" value="{% if trabajador %}{{ trabajador.edad }}{% endif %}" readonly>
            </div>
            <div class="form-group">
                <label for="direccion">Dirección:</label>
                <input type="text" id="direccion" name="direccion" value="{% if trabajador %}{{ trabajador.direccion }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="estado_civil">Estado civil:</label>
                <select id="estado_civil" name="estado_civil" onchange="mostrarDatosConyuge(); calcularCargaFamiliar()">
                    <option value="Soltero" {% if trabajador and trabajador.estado_civil == 'Soltero' %}selected{% endif %}>Soltero</option>
                    <option value="Casado" {% if trabajador and trabajador.estado_civil == 'Casado' %}selected{% endif %}>Casado</option>
                    <option value="Viudo" {% if trabajador and trabajador.estado_civil == 'Viudo' %}selected{% endif %}>Viudo</option>
                    <option value="Union" {% if trabajador and trabajador.estado_civil == 'Union' %}selected{% endif %}>Unión Estable</option>
                </select>
            </div>
            <div id="datos-conyuge" class="{% if not trabajador or trabajador.estado_civil == 'Soltero' %}hidden{% endif %}">
                <h4>Datos del Cónyuge</h4>
                <div class="form-group">
                    <label for="nombre_conyuge">Nombre del Cónyuge:</label>
                    <input type="text" id="nombre_conyuge" name="nombre_conyuge" value="{% if trabajador %}{{ trabajador.nombre_conyuge }}{% endif %}">
                </div>
                <div class="form-group">
                    <label for="cedula_conyuge">Cédula del Cónyuge:</label>
                    <input type="text" id="cedula_conyuge" name="cedula_conyuge" value="{% if trabajador %}{{ trabajador.cedula_conyuge }}{% endif %}">
                </div>
            </div>
            <div class="form-group">
                <label for="tiene_familiares">Tiene Otros Familiares:</label>
                <select id="tiene_familiares" name="tiene_familiares" onchange="mostrarDatosFamiliares(); calcularCargaFamiliar()">
                    <option value="No" {% if trabajador and trabajador.tiene_familiares == 'No' %}selected{% endif %}>No</option>
                    <option value="Sí" {% if trabajador and trabajador.tiene_familiares == 'Sí' %}selected{% endif %}>Sí</option>
                </select>
            </div>
            <div id="datos-familiares" class="{% if not trabajador or trabajador.tiene_familiares == 'No' %}hidden{% endif %}">
                <h4>Datos del Familiar</h4>
                <div class="form-group">
                    <label for="nombre_familiar">Nombre del Familiar:</label>
                    <input type="text" id="nombre_familiar" name="nombre_familiar" value="{% if trabajador %}{{ trabajador.nombre_familiar }}{% endif %}">
                </div>
                <div class="form-group">
                    <label for="parentesco_familiar">Parentesco del Familiar:</label>
                    <input type="text" id="parentesco_familiar" name="parentesco_familiar" value="{% if trabajador %}{{ trabajador.parentesco_familiar }}{% endif %}">
                </div>
                <div class="form-group">
                    <label for="fecha_nacimiento_familiar">Fecha de Nacimiento del Familiar:</label>
                    <input type="date" id="fecha_nacimiento_familiar" name="fecha_nacimiento_familiar" value="{% if trabajador %}{{ trabajador.fecha_nacimiento_familiar }}{% endif %}" onchange="calcularEdadFamiliar()">
                </div>
                <div class="form-group">
                    <label for="edad_familiar">Edad del Familiar:</label>
                    <input type="text" id="edad_familiar" name="edad_familiar" value="{% if trabajador %}{{ trabajador.edad_familiar }}{% endif %}" readonly>
                </div>
            </div>
            <div class="form-group">
                <label for="tiene_hijos">Tienes Hijos:</label>
                <select id="tiene_hijos" name="tiene_hijos" onchange="mostrarCantidadHijos()">
                    <option value="No" {% if trabajador and trabajador.tiene_hijos == 'No' %}selected{% endif %}>No</option>
                    <option value="Sí" {% if trabajador and trabajador.tiene_hijos == 'Sí' %}selected{% endif %}>Sí</option>
                </select>
            </div>
            <div id="cantidad-hijos-container" class="{% if not trabajador or trabajador.tiene_hijos == 'No' %}hidden{% endif %}">
                <div class="form-group">
                    <label for="cantidad_hijos">¿Cuántos Hijos Tienes (máx. 7)?</label>
                    <select id="cantidad_hijos" name="cantidad_hijos" onchange="mostrarDatosHijos(); calcularCargaFamiliar()">
                        <option value="0" {% if trabajador and trabajador.cantidad_hijos == 0 %}selected{% endif %}>0</option>
                        <option value="1" {% if trabajador and trabajador.cantidad_hijos == 1 %}selected{% endif %}>1</option>
                        <option value="2" {% if trabajador and trabajador.cantidad_hijos == 2 %}selected{% endif %}>2</option>
                        <option value="3" {% if trabajador and trabajador.cantidad_hijos == 3 %}selected{% endif %}>3</option>
                        <option value="4" {% if trabajador and trabajador.cantidad_hijos == 4 %}selected{% endif %}>4</option>
                        <option value="5" {% if trabajador and trabajador.cantidad_hijos == 5 %}selected{% endif %}>5</option>
                        <option value="6" {% if trabajador and trabajador.cantidad_hijos == 6 %}selected{% endif %}>6</option>
                        <option value="7" {% if trabajador and trabajador.cantidad_hijos == 7 %}selected{% endif %}>7</option>
                    </select>
                </div>
            </div>
            <div id="datos-hijos-container">
                {% if trabajador and trabajador.hijos %}
                    {% for i in range(trabajador.cantidad_hijos | int) %}
                        <div class="hijo-form">
                            <h4>Datos del Hijo {{ i + 1 }}</h4>
                            <div class="form-group">
                                <label for="genero_hijo_{{ i }}">Género:</label>
                                <select id="genero_hijo_{{ i }}" name="hijos[{{ i }}][genero]">
                                    <option value="Masculino" {% if trabajador.hijos[i] and trabajador.hijos[i].genero == 'Masculino' %}selected{% endif %}>Masculino</option>
                                    <option value="Femenino" {% if trabajador.hijos[i] and trabajador.hijos[i].genero == 'Femenino' %}selected{% endif %}>Femenino</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="nombres_hijo_{{ i }}">Nombres:</label>
                                <input type="text" id="nombres_hijo_{{ i }}" name="hijos[{{ i }}][nombres]" value="{% if trabajador.hijos[i] %}{{ trabajador.hijos[i].nombres }}{% endif %}">
                            </div>
                            <div class="form-group">
                                <label for="fecha_nacimiento_hijo_{{ i }}">Fecha de nacimiento:</label>
                                <input type="date" id="fecha_nacimiento_hijo_{{ i }}" name="hijos[{{ i }}][fecha_nacimiento]" value="{% if trabajador.hijos[i] %}{{ trabajador.hijos[i].fecha_nacimiento }}{% endif %}" onchange="calcularEdadHijo({{ i }})">
                            </div>
                            <div class="form-group">
                                <label for="edad_hijo_{{ i }}">Edad:</label>
                                <input type="text" id="edad_hijo_{{ i }}" name="hijos[{{ i }}][edad]" value="{% if trabajador.hijos[i] %}{{ trabajador.hijos[i].edad }}{% endif %}" readonly>
                            </div>
                            <div class="form-group">
                                <label for="talla_zapato_hijo_{{ i }}">Talla de zapato:</label>
                                <input type="text" id="talla_zapato_hijo_{{ i }}" name="hijos[{{ i }}][talla_zapato]" value="{% if trabajador.hijos[i] %}{{ trabajador.hijos[i].talla_zapato }}{% endif %}">
                            </div>
                            <div class="form-group">
                                <label for="talla_camisa_hijo_{{ i }}">Talla de camisa:</label>
                                <input type="text" id="talla_camisa_hijo_{{ i }}" name="hijos[{{ i }}][talla_camisa]" value="{% if trabajador.hijos[i] %}{{ trabajador.hijos[i].talla_camisa }}{% endif %}">
                            </div>
                            <div class="form-group">
                                <label for="talla_pantalon_hijo_{{ i }}">Talla de pantalón:</label>
                                <input type="text" id="talla_pantalon_hijo_{{ i }}" name="hijos[{{ i }}][talla_pantalon]" value="{% if trabajador.hijos[i] %}{{ trabajador.hijos[i].talla_pantalon }}{% endif %}">
                            </div>
                            <div class="form-group">
                                <label for="enfermedad_hijo_{{ i }}">Padece Enfermedad:</label>
                                <select id="enfermedad_hijo_{{ i }}" name="hijos[{{ i }}][enfermedad]">
                                    <option value="No" {% if trabajador.hijos[i] and trabajador.hijos[i].enfermedad == 'No' %}selected{% endif %}>No</option>
                                    <option value="Sí" {% if trabajador.hijos[i] and trabajador.hijos[i].enfermedad == 'Sí' %}selected{% endif %}>Sí</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="tratamiento_hijo_{{ i }}">Tratamiento:</label>
                                <input type="text" id="tratamiento_hijo_{{ i }}" name="hijos[{{ i }}][tratamiento]" value="{% if trabajador.hijos[i] %}{{ trabajador.hijos[i].tratamiento }}{% endif %}">
                            </div>
                            <div class="form-group">
                                <label for="discapacidad_hijo_{{ i }}">Discapacidad:</label>
                                <select id="discapacidad_hijo_{{ i }}" name="hijos[{{ i }}][discapacidad]">
                                    <option value="No" {% if trabajador.hijos[i] and trabajador.hijos[i].discapacidad == 'No' %}selected{% endif %}>No</option>
                                    <option value="Sí" {% if trabajador.hijos[i] and trabajador.hijos[i].discapacidad == 'Sí' %}selected{% endif %}>Sí</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="tipo_discapacidad_hijo_{{ i }}">Tipo de discapacidad:</label>
                                <input type="text" id="tipo_discapacidad_hijo_{{ i }}" name="hijos[{{ i }}][tipo_discapacidad]" value="{% if trabajador.hijos[i] %}{{ trabajador.hijos[i].tipo_discapacidad }}{% endif %}">
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
            <div class="form-group">
                <label for="total_carga_familiar">Total Carga Familiar:</label>
                <input type="text" id="total_carga_familiar" name="total_carga_familiar" value="{% if trabajador %}{{ trabajador.total_carga_familiar }}{% endif %}" readonly>
            </div>
        </div>

        <div class="form-section">
            <h3>Datos de Contacto</h3>
            <div class="form-group">
                <label for="telefono_movil">Teléfono móvil:</label>
                <input type="text" id="telefono_movil" name="telefono_movil" value="{% if trabajador %}{{ trabajador.telefono_movil }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="telefono_local">Teléfono local:</label>
                <input type="text" id="telefono_local" name="telefono_local" value="{% if trabajador %}{{ trabajador.telefono_local }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="telefono_referencia">Teléfono de referencia:</label>
                <input type="text" id="telefono_referencia" name="telefono_referencia" value="{% if trabajador %}{{ trabajador.telefono_referencia }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="correo_electronico">Correo electrónico:</label>
                <input type="email" id="correo_electronico" name="correo_electronico" value="{% if trabajador %}{{ trabajador.correo_electronico }}{% endif %}">
            </div>
        </div>

        <div class="form-section">
            <h3>Datos Política</h3>
            <div class="form-group">
                <label for="org_social">Pertenece a Org. Social:</label>
                <input type="text" id="org_social" name="org_social" value="{% if trabajador %}{{ trabajador.org_social }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="voceria">Vocería:</label>
                <input type="text" id="voceria" name="voceria" value="{% if trabajador %}{{ trabajador.voceria }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="pertenece_psuv">Pertenece a PSUV:</label>
                <select id="pertenece_psuv" name="pertenece_psuv">
                    <option value="No" {% if trabajador and trabajador.pertenece_psuv == 'No' %}selected{% endif %}>No</option>
                    <option value="Sí" {% if trabajador and trabajador.pertenece_psuv == 'Sí' %}selected{% endif %}>Sí</option>
                </select>
            </div>
            <div class="form-group">
                <label for="lugar_vota">Lugar donde Vota:</label>
                <input type="text" id="lugar_vota" name="lugar_vota" value="{% if trabajador %}{{ trabajador.lugar_vota }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="tiene_emprendimiento">Tiene Emprendimiento Registrado:</label>
                <select id="tiene_emprendimiento" name="tiene_emprendimiento">
                    <option value="No" {% if trabajador and trabajador.tiene_emprendimiento == 'No' %}selected{% endif %}>No</option>
                    <option value="Sí" {% if trabajador and trabajador.tiene_emprendimiento == 'Sí' %}selected{% endif %}>Sí</option>
                </select>
            </div>
            <div class="form-group">
                <label for="nombre_consejo_comunal">Nombre del Consejo Comunal:</label>
                <input type="text" id="nombre_consejo_comunal" name="nombre_consejo_comunal" value="{% if trabajador %}{{ trabajador.nombre_consejo_comunal }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="nombre_comuna">Nombre de la Comuna:</label>
                <input type="text" id="nombre_comuna" name="nombre_comuna" value="{% if trabajador %}{{ trabajador.nombre_comuna }}{% endif %}">
            </div>
        </div>

        <div class="form-section">
            <h3>Datos de Salud</h3>
            <div class="form-group">
                <label for="tipo_sangre">Tipo de sangre:</label>
                <select id="tipo_sangre" name="tipo_sangre">
                    <option value="">Seleccione</option>
                    <option value="O+" {% if trabajador and trabajador.tipo_sangre == 'O+' %}selected{% endif %}>O+</option>
                    <option value="O-" {% if trabajador and trabajador.tipo_sangre == 'O-' %}selected{% endif %}>O-</option>
                    <option value="A+" {% if trabajador and trabajador.tipo_sangre == 'A+' %}selected{% endif %}>A+</option>
                    <option value="A-" {% if trabajador and trabajador.tipo_sangre == 'A-' %}selected{% endif %}>A-</option>
                    <option value="B+" {% if trabajador and trabajador.tipo_sangre == 'B+' %}selected{% endif %}>B+</option>
                    <option value="B-" {% if trabajador and trabajador.tipo_sangre == 'B-' %}selected{% endif %}>B-</option>
                    <option value="AB+" {% if trabajador and trabajador.tipo_sangre == 'AB+' %}selected{% endif %}>AB+</option>
                    <option value="AB-" {% if trabajador and trabajador.tipo_sangre == 'AB-' %}selected{% endif %}>AB-</option>
                </select>
            </div>
            <div class="form-group">
                <label for="padece_enfermedad">Padece de alguna Enfermedad:</label>
                <select id="padece_enfermedad" name="padece_enfermedad" onchange="mostrarTratamiento()">
                    <option value="No" {% if trabajador and trabajador.padece_enfermedad == 'No' %}selected{% endif %}>No</option>
                    <option value="Sí" {% if trabajador and trabajador.padece_enfermedad == 'Sí' %}selected{% endif %}>Sí</option>
                </select>
            </div>
            <div id="tratamiento-container" class="{% if not trabajador or trabajador.padece_enfermedad == 'No' %}hidden{% endif %}">
                <div class="form-group">
                    <label for="tratamiento">Tratamiento:</label>
                    <input type="text" id="tratamiento" name="tratamiento" value="{% if trabajador %}{{ trabajador.tratamiento }}{% endif %}">
                </div>
            </div>
            <div class="form-group">
                <label for="discapacidad">Discapacidad:</label>
                <select id="discapacidad" name="discapacidad" onchange="mostrarTipoDiscapacidad()">
                    <option value="No" {% if trabajador and trabajador.discapacidad == 'No' %}selected{% endif %}>No</option>
                    <option value="Sí" {% if trabajador and trabajador.discapacidad == 'Sí' %}selected{% endif %}>Sí</option>
                </select>
            </div>
            <div id="tipo-discapacidad-container" class="{% if not trabajador or trabajador.discapacidad == 'No' %}hidden{% endif %}">
                <div class="form-group">
                    <label for="tipo_discapacidad">Tipo de discapacidad:</label>
                    <input type="text" id="tipo_discapacidad" name="tipo_discapacidad" value="{% if trabajador %}{{ trabajador.tipo_discapacidad }}{% endif %}">
                </div>
            </div>
        </div>

        <div class="form-section">
            <h3>Datos Talla del Trabajador</h3>
            <div class="form-group">
                <label for="talla_zapato">Talla de zapato:</label>
                <select id="talla_zapato" name="talla_zapato">
                    <option value="">Seleccione</option>
                    <option value="35" {% if trabajador and trabajador.talla_zapato == '35' %}selected{% endif %}>35</option>
                    <option value="36" {% if trabajador and trabajador.talla_zapato == '36' %}selected{% endif %}>36</option>
                    <option value="37" {% if trabajador and trabajador.talla_zapato == '37' %}selected{% endif %}>37</option>
                    <option value="38" {% if trabajador and trabajador.talla_zapato == '38' %}selected{% endif %}>38</option>
                    <option value="39" {% if trabajador and trabajador.talla_zapato == '39' %}selected{% endif %}>39</option>
                    <option value="40" {% if trabajador and trabajador.talla_zapato == '40' %}selected{% endif %}>40</option>
                    <option value="41" {% if trabajador and trabajador.talla_zapato == '41' %}selected{% endif %}>41</option>
                    <option value="42" {% if trabajador and trabajador.talla_zapato == '42' %}selected{% endif %}>42</option>
                    <option value="43" {% if trabajador and trabajador.talla_zapato == '43' %}selected{% endif %}>43</option>
                    <option value="44" {% if trabajador and trabajador.talla_zapato == '44' %}selected{% endif %}>44</option>
                    <option value="45" {% if trabajador and trabajador.talla_zapato == '45' %}selected{% endif %}>45</option>
                </select>
            </div>
            <div class="form-group">
                <label for="talla_camisa">Talla de camisa:</label>
                <select id="talla_camisa" name="talla_camisa">
                    <option value="">Seleccione</option>
                    <option value="S" {% if trabajador and trabajador.talla_camisa == 'S' %}selected{% endif %}>S</option>
                    <option value="M" {% if trabajador and trabajador.talla_camisa == 'M' %}selected{% endif %}>M</option>
                    <option value="L" {% if trabajador and trabajador.talla_camisa == 'L' %}selected{% endif %}>L</option>
                    <option value="XL" {% if trabajador and trabajador.talla_camisa == 'XL' %}selected{% endif %}>XL</option>
                    <option value="XXL" {% if trabajador and trabajador.talla_camisa == 'XXL' %}selected{% endif %}>XXL</option>
                </select>
            </div>
            <div class="form-group">
                <label for="talla_pantalon">Talla de pantalón:</label>
                <select id="talla_pantalon" name="talla_pantalon">
                    <option value="">Seleccione</option>
                    <option value="28" {% if trabajador and trabajador.talla_pantalon == '28' %}selected{% endif %}>28</option>
                    <option value="30" {% if trabajador and trabajador.talla_pantalon == '30' %}selected{% endif %}>30</option>
                    <option value="32" {% if trabajador and trabajador.talla_pantalon == '32' %}selected{% endif %}>32</option>
                    <option value="34" {% if trabajador and trabajador.talla_pantalon == '34' %}selected{% endif %}>34</option>
                    <option value="36" {% if trabajador and trabajador.talla_pantalon == '36' %}selected{% endif %}>36</option>
                    <option value="38" {% if trabajador and trabajador.talla_pantalon == '38' %}selected{% endif %}>38</option>
                    <option value="40" {% if trabajador and trabajador.talla_pantalon == '40' %}selected{% endif %}>40</option>
                    <option value="42" {% if trabajador and trabajador.talla_pantalon == '42' %}selected{% endif %}>42</option>
                </select>
            </div>
        </div>

        <div class="form-section">
            <h3>Datos Nomina</h3>
            <div class="form-group">
                <label for="fecha_ingreso">Fecha de ingreso:</label>
                <input type="date" id="fecha_ingreso" name="fecha_ingreso" value="{% if trabajador %}{{ trabajador.fecha_ingreso }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="cargo">Cargo:</label>
                <input type="text" id="cargo" name="cargo" value="{% if trabajador %}{{ trabajador.cargo }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="ubicacion">Ubicación:</label>
                <input type="text" id="ubicacion" name="ubicacion" value="{% if trabajador %}{{ trabajador.ubicacion }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="departamento">Departamento:</label>
                <input type="text" id="departamento" name="departamento" value="{% if trabajador %}{{ trabajador.departamento }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="jefe">Jefe:</label>
                <input type="text" id="jefe" name="jefe" value="{% if trabajador %}{{ trabajador.jefe }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="salario_prima">Salario prima:</label>
                <input type="text" id="salario_prima" name="salario_prima" value="{% if trabajador %}{{ trabajador.salario_prima }}{% endif %}">
            </div>
            <div class="form-group">
                <label for="salario_sin_prima">Salario sin prima:</label>
                <input type="text" id="salario_sin_prima" name="salario_sin_prima" value="{% if trabajador %}{{ trabajador.salario_sin_prima }}{% endif %}">
            </div>
        </div>

        <button type="submit">Guardar Cambios</button>

        <div id="confirmacion-guardado" class="mensaje-confirmacion hidden">
            <p>Está por modificar los datos del trabajador. ¿Desea continuar?</p>
            <button type="button" onclick="document.querySelector('form').submit();">Aceptar</button>
            <button type="button" onclick="cancelarGuardado()">Cancelar</button>
        </div>

        <script>
            function mostrarDatosConyuge() {
                const estadoCivil = document.getElementById('estado_civil').value;
                const datosConyugeDiv = document.getElementById('datos-conyuge');
                if (estadoCivil !== 'Soltero') {
                    datosConyugeDiv.classList.remove('hidden');
                } else {
                    datosConyugeDiv.classList.add('hidden');
                }
            }

            function mostrarDatosFamiliares() {
                const tieneFamiliares = document.getElementById('tiene_familiares').value;
                const datosFamiliaresDiv = document.getElementById('datos-familiares');
                if (tieneFamiliares === 'Sí') {
                    datosFamiliaresDiv.classList.remove('hidden');
                } else {
                    datosFamiliaresDiv.classList.add('hidden');
                }
            }

            function mostrarTratamiento() {
                const padeceEnfermedad = document.getElementById('padece_enfermedad').value;
                const tratamientoDiv = document.getElementById('tratamiento-container');
                if (padeceEnfermedad === 'Sí') {
                    tratamientoDiv.classList.remove('hidden');
                } else {
                    tratamientoDiv.classList.add('hidden');
                }
            }

            function mostrarTipoDiscapacidad() {
                const discapacidad = document.getElementById('discapacidad').value;
                const tipoDiscapacidadDiv = document.getElementById('tipo-discapacidad-container');
                if (discapacidad === 'Sí') {
                    tipoDiscapacidadDiv.classList.remove('hidden');
                } else {
                    tipoDiscapacidadDiv.classList.add('hidden');
                }
            }

            function calcularEdad() {
                const fechaNacimientoInput = document.getElementById('fecha_nacimiento');
                const edadInput = document.getElementById('edad');
                const fechaNacimiento = new Date(fechaNacimientoInput.value);
                const hoy = new Date();
                let edad = hoy.getFullYear() - fechaNacimiento.getFullYear();
                const mes = hoy.getMonth() - fechaNacimiento.getMonth();
                if (mes < 0 || (mes === 0 && hoy.getDate() < fechaNacimiento.getDate())) {
                    edad--;
                }
                edadInput.value = edad >= 0 ? edad : '';
            }

            function calcularEdadFamiliar() {
                const fechaNacimientoInput = document.getElementById('fecha_nacimiento_familiar');
                const edadInput = document.getElementById('edad_familiar');
                const fechaNacimiento = new Date(fechaNacimientoInput.value);
                const hoy = new Date();
                let edad = hoy.getFullYear() - fechaNacimiento.getFullYear();
                const mes = hoy.getMonth() - fechaNacimiento.getMonth();
                if (mes < 0 || (mes === 0 && hoy.getDate() < fechaNacimiento.getDate())) {
                    edad--;
                }
                edadInput.value = edad >= 0 ? edad : '';
            }

            function mostrarCantidadHijos() {
                const tieneHijosSelect = document.getElementById('tiene_hijos');
                const cantidadHijosContainer = document.getElementById('cantidad-hijos-container');
                const cantidadHijosSelectElement = document.getElementById('cantidad_hijos');
                const datosHijosContainer = document.getElementById('datos-hijos-container');

                if (tieneHijosSelect.value === 'Sí') {
                    cantidadHijosContainer.classList.remove('hidden');
                    datosHijosContainer.innerHTML = '';
                    const cantidad = parseInt(document.getElementById('cantidad_hijos').value);
                    for (let i = 0; i < cantidad; i++) {
                        agregarFormularioHijo(i);
                    }
                } else {
                    cantidadHijosContainer.classList.add('hidden');
                    datosHijosContainer.innerHTML = '';
                }
            }

            function mostrarDatosHijos() {
                const cantidadHijos = parseInt(document.getElementById('cantidad_hijos').value);
                const datosHijosContainer = document.getElementById('datos-hijos-container');
                datosHijosContainer.innerHTML = ''; // Limpiar formularios anteriores

                for (let i = 0; i < cantidadHijos; i++) {
                    agregarFormularioHijo(i);
                }
                calcularCargaFamiliar();
            }

            function agregarFormularioHijo(index) {
                const datosHijosContainer = document.getElementById('datos-hijos-container');
                const hijoDiv = document.createElement('div');
                hijoDiv.classList.add('hijo-form');
                hijoDiv.innerHTML = `
                    <h4>Datos del Hijo ${index + 1}</h4>
                    <div class="form-group">
                        <label for="genero_hijo_${index}">Género:</label>
                        <select id="genero_hijo_${index}" name="hijos[${index}][genero]">
                            <option value="Masculino" {% if trabajador and trabajador.hijos and trabajador.hijos[index] and trabajador.hijos[index].genero == 'Masculino' %}selected{% endif %}>Masculino</option>
                            <option value="Femenino" {% if trabajador and trabajador.hijos and trabajador.hijos[index] and trabajador.hijos[index].genero == 'Femenino' %}selected{% endif %}>Femenino</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="nombres_hijo_${index}">Nombres:</label>
                        <input type="text" id="nombres_hijo_${index}" name="hijos[${index}][nombres]" value="{% if trabajador and trabajador.hijos and trabajador.hijos[index] %}{{ trabajador.hijos[index].nombres }}{% endif %}">
                    </div>
                    <div class="form-group">
                        <label for="fecha_nacimiento_hijo_${index}">Fecha de nacimiento:</label>
                        <input type="date" id="fecha_nacimiento_hijo_${index}" name="hijos[${index}][fecha_nacimiento]" value="{% if trabajador and trabajador.hijos and trabajador.hijos[index] %}{{ trabajador.hijos[index].fecha_nacimiento }}{% endif %}" onchange="calcularEdadHijo(${index})">
                    </div>
                    <div class="form-group">
                        <label for="edad_hijo_${index}">Edad:</label>
                        <input type="text" id="edad_hijo_${index}" name="hijos[${index}][edad]" value="{% if trabajador and trabajador.hijos and trabajador.hijos[index] %}{{ trabajador.hijos[index].edad }}{% endif %}" readonly>
                    </div>
                    <div class="form-group">
                        <label for="talla_zapato_hijo_${index}">Talla de zapato:</label>
                        <input type="text" id="talla_zapato_hijo_${index}" name="hijos[${index}][talla_zapato]" value="{% if trabajador and trabajador.hijos and trabajador.hijos[index] %}{{ trabajador.hijos[index].talla_zapato }}{% endif %}">
                    </div>
                    <div class="form-group">
                        <label for="talla_camisa_hijo_${index}">Talla de camisa:</label>
                        <input type="text" id="talla_camisa_hijo_${index}" name="hijos[${index}][talla_camisa]" value="{% if trabajador and trabajador.hijos and trabajador.hijos[index] %}{{ trabajador.hijos[index].talla_camisa }}{% endif %}">
                    </div>
                    <div class="form-group">
                        <label for="talla_pantalon_hijo_${index}">Talla de pantalón:</label>
                        <input type="text" id="talla_pantalon_hijo_${index}" name="hijos[${index}][talla_pantalon]" value="{% if trabajador and trabajador.hijos and trabajador.hijos[index] %}{{ trabajador.hijos[index].talla_pantalon }}{% endif %}">
                    </div>
                    <div class="form-group">
                        <label for="enfermedad_hijo_${index}">Padece Enfermedad:</label>
                        <select id="enfermedad_hijo_${index}" name="hijos[${index}][enfermedad]">
                            <option value="No" {% if trabajador and trabajador.hijos and trabajador.hijos[index] and trabajador.hijos[index].enfermedad == 'No' %}selected{% endif %}>No</option>
                            <option value="Sí" {% if trabajador and trabajador.hijos and trabajador.hijos[index] and trabajador.hijos[index].enfermedad == 'Sí' %}selected{% endif %}>Sí</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tratamiento_hijo_${index}">Tratamiento:</label>
                        <input type="text" id="tratamiento_hijo_${index}" name="hijos[${index}][tratamiento]" value="{% if trabajador and trabajador.hijos and trabajador.hijos[index] %}{{ trabajador.hijos[index].tratamiento }}{% endif %}">
                    </div>
                    <div class="form-group">
                        <label for="discapacidad_hijo_${index}">Discapacidad:</label>
                        <select id="discapacidad_hijo_${index}" name="hijos[${index}][discapacidad]">
                            <option value="No" {% if trabajador and trabajador.hijos and trabajador.hijos[index] and trabajador.hijos[index].discapacidad == 'No' %}selected{% endif %}>No</option>
                            <option value="Sí" {% if trabajador and trabajador.hijos and trabajador.hijos[index] and trabajador.hijos[index].discapacidad == 'Sí' %}selected{% endif %}>Sí</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="tipo_discapacidad_hijo_${index}">Tipo de discapacidad:</label>
                        <input type="text" id="tipo_discapacidad_hijo_${index}" name="hijos[${index}][tipo_discapacidad]" value="{% if trabajador and trabajador.hijos and trabajador.hijos[index] %}{{ trabajador.hijos[index].tipo_discapacidad }}{% endif %}">
                    </div>
                `;
                datosHijosContainer.appendChild(hijoDiv);
            }

            function calcularEdadHijo(index) {
                const fechaNacimientoInput = document.getElementById(`fecha_nacimiento_hijo_${index}`);
                const edadInput = document.getElementById(`edad_hijo_${index}`);
                const fechaNacimiento = new Date(fechaNacimientoInput.value);
                const hoy = new Date();
                let edad = hoy.getFullYear() - fechaNacimiento.getFullYear();
                const mes = hoy.getMonth() - fechaNacimiento.getMonth();
                if (mes < 0 || (mes === 0 && hoy.getDate() < fechaNacimiento.getDate())) {
                    edad--;
                }
                edadInput.value = edad >= 0 ? edad : '';
            }

            function calcularCargaFamiliar() {
                let totalCarga = 1; // El trabajador cuenta como 1
                const estadoCivil = document.getElementById('estado_civil').value;
                const tieneFamiliares = document.getElementById('tiene_familiares').value;
                const cantidadHijos = parseInt(document.getElementById('cantidad_hijos').value);

                if (estadoCivil !== 'Soltero') {
                    totalCarga++;
                }
                if (tieneFamiliares === 'Sí') {
                    totalCarga++;
                }
                totalCarga += cantidadHijos;

                document.getElementById('total_carga_familiar').value = totalCarga;
            }

            function confirmarGuardado() {
                document.getElementById('confirmacion-guardado').classList.remove('hidden');
                return false; // Evita el envío inmediato del formulario
            }

            function cancelarGuardado() {
                document.getElementById('confirmacion-guardado').classList.add('hidden');
            }

            // Llamar a las funciones al cargar la página para establecer el estado inicial
            window.onload = function() {
                mostrarDatosConyuge();
                mostrarDatosFamiliares();
                mostrarTratamiento();
                mostrarTipoDiscapacidad();
                const tieneHijosSelect = document.getElementById('tiene_hijos');
                if (tieneHijosSelect.value === 'Sí') {
                    document.getElementById('cantidad-hijos-container').classList.remove('hidden');
                    mostrarDatosHijos();
                }
                calcularCargaFamiliar();
            };
        </script>
    </form>
</body>
</html>